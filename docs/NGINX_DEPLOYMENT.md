# NGINX Deployment Process

The project uses a standalone NGINX instance as a reverse proxy in front of the Spring Boot backend.

Configuration files live on the server and are deployed together with the systemd unit. Cluster manifests are no longer maintained.

Static files generated by the frontend build are uploaded to `/opt/schedule-app/frontend` and served directly by NGINX. API requests under `/api/` are proxied to the Spring Boot application running on port `8080`.
For all other paths NGINX tries to serve a static file and falls back to `index.html` so that the client-side router can handle routes.

A sample configuration is provided in `infra/nginx/crm-synergy.conf`:

```nginx
server {
    listen 80;
    listen [::]:80;
    server_name crm-synergy.ru www.crm-synergy.ru;

    root /opt/schedule-app/frontend;

    location /api/ {
        proxy_pass         http://127.0.0.1:8080;
        proxy_http_version 1.1;
        proxy_set_header   Host              $host;
        proxy_set_header   X-Real-IP         $remote_addr;
        proxy_set_header   X-Forwarded-For   $proxy_add_x_forwarded_for;
        proxy_set_header   X-Forwarded-Proto $scheme;
    }

    location / {
        try_files $uri $uri/ /index.html;
    }
}
```

Deploy the file to `/etc/nginx/sites-available/` and create a symlink in `sites-enabled`. After every deployment run `nginx -t` followed by `systemctl reload nginx` to apply the changes.
