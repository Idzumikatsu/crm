1. Сбор исходных данных
1.1 Сформировать ответственного за этап аудита.
1.2 Получить полный перечень внешних и внутренних HTTP/WS/GRPC-эндпоинтов.
1.3 Зафиксировать для каждого эндпоинта метод, URI и тип протокола.
1.4 Собрать метрики нагрузки (средняя, пиковая, тренд) за последний отчётный период.
1.5 Уточнить целевые SLA по задержке ответа и уровню доступности.
1.6 Определить юридические и корпоративные требования к защите данных и логированию.
1.7 Зафиксировать текущее место завершения TLS-шифрования.
1.8 Согласовать распределение обязанностей между NGINX и приложением (кеш, SSL, лимиты, WAF).
1.9 Консолидировать все выводы в единый документ «NGINX Requirements».

2. Проектная топология
2.1 Подготовить схему фактических сетевых потоков.
2.2 Принять решение о режиме развёртывания NGINX (отдельный слой, sidecar, DaemonSet).
2.3 Определить стратегию балансировки трафика между бэкендами.
2.4 Провести оценку совместимости клиентов с HTTP/2 и, при необходимости, HTTP/3.
2.5 Зафиксировать политику поэтапных релизов (blue-green, canary).
2.6 Утвердить целевую архитектурную схему и добавить в дизайн-док.

3. Производительность и масштабирование
3.1 Определить требуемое количество рабочих процессов под доступные вычислительные ресурсы.
3.2 Установить расчётный максимум одновременных соединений.
3.3 Согласовать политику keep-alive (тайм-ауты, лимиты).
3.4 Определить, какие типы контента должны сжиматься и каким алгоритмом.
3.5 Задать предельные значения внутренних тайм-аутов проксирования на основе p99-задержек.
3.6 Сформировать документ с базовыми производительными ориентирами.

4. Безопасность
4.1 Установить минимально допустимую версию TLS и список приемлемых шифров.
4.2 Включить обязательную политику HSTS и проверку статуса сертификатов.
4.3 Сконфигурировать ограничения скорости запросов, ориентируясь на собранную статистику.
4.4 Определить набор WAF-правил, охватывающий основные угрозы OWASP Top-10.
4.5 Установить допустимые пределы размера тела запроса для разных категорий маршрутов.
4.6 Создать контрольный лист проверки безопасности перед выпуском в эксплуатацию.

5. Кеширование и статика
5.1 Классифицировать пути статического контента и динамических API-ресурсов.
5.2 Фиксировать требования к идентификации версионных ассетов (хеш-имена).
5.3 Установить сроки кэширования и директивы Cache-Control для статических файлов.
5.4 Определить правила кратковременного кеша для публичных GET-запросов.
5.5 Спроектировать процесс инвалидирования кеша при обновлениях приложения.

6. Долгоживущие соединения
6.1 Выделить перечень эндпоинтов, использующих WebSocket / SSE.
6.2 Определить требования к тайм-аутам чтения для постоянных соединений.
6.3 Задать порядок обработки сбоев соединения и повторных подключений.

7. Наблюдаемость и логирование
7.1 Согласовать унифицированный формат лог-записей (структурированный JSON).
7.2 Определить канал доставки логов в централизованную систему.
7.3 Определить список метрик, подлежащих сбору, и метод их экспорта.
7.4 Сформулировать набор пороговых алертов по ошибкам 5xx, задержкам, отказам upstream.
7.5 Подготовить типовые сценарии диагностики инцидентов.

8. Высокая доступность и отказоустойчивость
8.1 Рассчитать минимально необходимое количество экземпляров NGINX для заданной цели отказоустойчивости.
8.2 Установить правила исключения некорректно работающих бэкендов из пула.
8.3 Определить процедуру плавной перезагрузки конфигурации без прерывания трафика.
8.4 Составить план аварийного восстановления с задокументированными целевыми RTO / RPO.

9. Конвейер поставки и инфраструктура как код
9.1 Создать репозиторий конфигураций со строгим контролем версий и ревью.
9.2 Включить автоматическую валидацию синтаксиса конфигураций в CI-конвейер.
9.3 Шаблонизировать конфигурации, обеспечив единообразие окружений.
9.4 Определить политику постепенного вывода трафика и критерии автоматического отката.
9.5 Документировать полный процесс доставки изменений.

10. Документация и обучение
10.1 Организовать централизованное хранилище документации по NGINX внутри проекта.
10.2 Подготовить оперативные инструкции (runbook) для типовых сбоев.
10.3 Разработать обучающие материалы для разработчиков и SRE-команды.
10.4 Установить регламент периодического пересмотра и актуализации документации.
